<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Generator" content="Microsoft Word 12 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-right:0cm;
	margin-left:0cm;
	font-size:24.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-right:0cm;
	margin-left:0cm;
	font-size:13.5pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
code
	{font-family:"Courier New";}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.pubmonth
	{mso-style-name:pubmonth;}
span.pubday
	{mso-style-name:pubday;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.blogpubmonth
	{mso-style-name:blogpubmonth;}
span.blogpubdate
	{mso-style-name:blogpubdate;}
p.blogsubhead, li.blogsubhead, div.blogsubhead
	{mso-style-name:blogsubhead;
	margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
span.blogauthor
	{mso-style-name:blog_author;}
span.blogdate
	{mso-style-name:blogdate;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
span.lnum
	{mso-style-name:lnum;}
span.kwrd
	{mso-style-name:kwrd;}
span.str
	{mso-style-name:str;}
span.html
	{mso-style-name:html;}
span.attr
	{mso-style-name:attr;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:36.0pt 36.0pt 36.0pt 36.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body vlink="purple" lang="EN-GB" link="blue">

<div class="WordSection1">

<h2><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx">Occam’s
Razor and DotNetNuke</a></h2>

<p class="MsoNormal" style="line-height:normal"><a href="http://blog.theaccidentalgeek.com/image.axd?picture=Logo_3.png"></a><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Occam’s Razor is
an often referenced heuristic that basically states that the simplest
explanation is more likely to be the correct one.&nbsp; This principle has many
corollaries in computer science as we often strive to find the simplest
solution to a problem in order to keep the complexity of our applications under
control.&nbsp; The new ASP.Net Razor view engine embraces this philosophy and
certainly shows that even simple solutions can be very powerful.&nbsp; Charles
Nurse has a recent </span><a href="http://www.dotnetnuke.com/Resources/Blogs/tabid/825/BlogID/15/Default.aspx" target="_blank"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">series
of blog posts</span></a><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
which discuss how you can even use Razor within DotNetNuke, with the focus
being on lowering the barrier for creating DotNetNuke modules.</span></p>

<p class="MsoNormal" style="line-height:normal"><b><span style="font-size:13.5pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Building Razor Scripts for DotNetNuke</span></b></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">To highlight some of the capabilities of
the Razor Host module, I decided to create a quick script to display user
profiles.&nbsp; This is something that many organizations need, so I thought it
would be a great way to show off the power of Razor and show some integration
with DotNetNuke.&nbsp; I built a similar display using the Reports module in </span><a href="http://blog.theaccidentalgeek.com/post/2009/03/27/DNN-Tips-and-Tricks-10-Reports-Module.aspx" target="_blank"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">DotNetNuke
Tips &amp; Tricks #10</span></a><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">.&nbsp;
Looking at the two solutions, it is easy to see the huge differences between
the two approaches.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">My original version of the contact
listing, relied on a heavy dose of SQL and XSLT to create the listing.&nbsp; It
worked well, but if you look at the SQL and XSLT involved, you realize it is
not for the faint of heart.&nbsp; I think that the Razor version is much more
approachable for the average power user with a little bit of scripting and HTML
experience.&nbsp; To begin with, let's look at what I am trying to build:</span></p>

<p class="MsoNormal" style="line-height:normal"><a href="http://blog.theaccidentalgeek.com/image.axd?picture=modern_5.png"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;text-decoration:
none"><img id="Picture 1" src="DNNandRazor_files/image001.gif" alt="modern" width="279" border="0" height="253"></span></a></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">To get started, I add the Razor Host
module to the page.&nbsp; The Razor Host is a module that will help us create
our script, and render it to the page.&nbsp; When we first add the module to
the page, it will look pretty plain because we haven’t told it what module we
want displayed.</span></p>

<p class="MsoNormal" style="line-height:normal"><a href="http://blog.theaccidentalgeek.com/image.axd?picture=NewRazor_5.png"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;text-decoration:
none"><img id="Picture 2" src="DNNandRazor_files/image002.gif" alt="NewRazor" width="554" border="0" height="50"></span></a></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Clicking the “Edit Script” link will
open the script editor and allow us to choose and activate one of the
pre-installed scripts, edit a script or even create a new script.</span></p>

<p class="MsoNormal" style="line-height:normal"><a href="http://blog.theaccidentalgeek.com/image.axd?picture=EditScript_5.png"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;text-decoration:
none"><img id="Picture 3" src="DNNandRazor_files/image003.gif" alt="EditScript" width="349" border="0" height="238"></span></a></p>

<p class="MsoNormal" style="line-height:normal"><a href="http://blog.theaccidentalgeek.com/image.axd?picture=AddScript_5.png"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;text-decoration:
none"><img id="Picture 4" src="DNNandRazor_files/image004.gif" alt="AddScript" width="349" border="0" height="187"></span></a></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In my case, I want to create a new
script, so I click the “Add New Script File” link and enter TeamMembers as the
name of my script.&nbsp; I also choose to use C# for my script.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">This will create a simple script for me
and place it in the RazorModule/RazorHost/Scripts directory.&nbsp; The script
filename is automatically prepended with an underscore and the appropriate
extension for the type of script I am creating.&nbsp; The underscore ensures
that site visitors cannot craft a URL directly to the script file and is an
important security consideration since the developer may not want just any user
executing the script.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">At this point you are ready to begin
editing the script.&nbsp; You have a wide choice of editors to choose
from.&nbsp; If you only need to make a simple tweak to an existing script, you
can use the existing text box in DotNetNuke.&nbsp; Alternatively, if you open
the script in WebMatrix, you will have access to a more user friendly editing
experience.&nbsp; Unfortunately, I found the WebMatrix experience to be a
little frustrating since it does not have built in Intellisense to tell you
when your code won’t compile or to help you determine the available properties
or methods on an object.&nbsp; Microsoft invested a lot of man-years in
creating the Intellisense experience in Visual Studio and it is a little bit of
a let-down that they weren’t able to leverage that capability in
WebMatrix.&nbsp; Using WebMatrix, I often found that I would end up with
mismatched braces or parenthesis, or that my VB background would takeover and I
would use parenthesis when accessing an array element when I should have used square-brackets.&nbsp;
It is little things like this that make Visual Studio such a powerful editor.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Like most applications there are 3 main
components that we must be concerned with when creating our Razor scripts:
data, presentation and behaviour.&nbsp; Razor provides the ability to directly
query the database using some straight forward syntax.&nbsp; Of course, that is
not recommended for most DotNetNuke applications, since the database is not
guaranteed to be backwards compatible.&nbsp; Also, if you looked at my earlier
report module example, you will see that the SQL for working with user profile
data is not exactly simple.&nbsp; Because Razor has full code support, we can
and should take advantage of the existing business layer in DotNetNuke.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Using the business layer I can get all
of my user data with just a few lines of code:</span></p>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#viewSource" title="view source"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">view
source</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#printSource" title="print"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">print</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#about" title="?"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">?</span></a></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">1</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@using</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Security.Roles</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">2</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">3</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@{ </span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">4</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;var
  users = (new</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">RoleController()).GetUsersByRoleName(Dnn.Portal.PortalId,
  "Coreteam");</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">5</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Compared to the 100+ lines of SQL I had
in my previous example, this is much easier.&nbsp;&nbsp; In this example, I am
just retrieving a list of users who are in a specific role.&nbsp; This is
perfect for my script. The real benefit is that DotNetNuke has a very rich API
already for accessing all of the data for your website, so there is probably
some way to get the data you need for your script without resorting to SQL.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">With my user data in hand, I just use a
simple foreach loop to output the same block of HTML over and over again for
each user in my data set.&nbsp; When developing my script, I found that the
same script pattern was repeated over and over again.&nbsp; I often wanted to
output a chunk of HTML to display some profile property, but if the user had
not filled out that profile element, I wanted to hide the element on the
page.&nbsp; Notice that in the picture above, that my listing shows a Twitter
link, but the listing for Scott Willhite doesn’t have that link.&nbsp; With
Razor I can define methods inside a “function” block which are then available
to the other script on my page.</span></p>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#viewSource" title="view source"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">view
source</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#printSource" title="print"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">print</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#about" title="?"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">?</span></a></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">01</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@functions {</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">02</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;public</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">static</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">GetProfileProperty(UserProfile
  profile, string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">propertyName)</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">03</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">04</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;ProfilePropertyDefinition
  objProperty = profile.GetProperty(propertyName);</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">05</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(objProperty == null</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">|| string.IsNullOrEmpty(objProperty.PropertyValue))
  return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string.Empty;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">06</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">07</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">objProperty.PropertyValue;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">08</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">09</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">10</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;public</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">static</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">GetFormattedProfileProperty(UserProfile
  profile, string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">propertyName,
  string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">tagformat)</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">11</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">12</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">propertyval =
  GetProfileProperty(profile, propertyName);</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">13</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(propertyval !=
  string.Empty)</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">14</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">15</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string.Format(tagformat,
  @propertyval);</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">16</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">17</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string.Empty;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">18</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">19</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Using these functions I can now display
profile properties with a simple call:</span></p>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#viewSource" title="view source"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">view
source</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#printSource" title="print"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">print</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#about" title="?"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">?</span></a></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">1</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@GetFormattedProfileProperty(user.Profile,
  "CompanyName", "&lt;div class=\"company\"&gt;{0}&lt;/div&gt;")</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Putting it all together with some
additional HTML we end up with the following script.</span></p>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#viewSource" title="view source"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">view
source</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#printSource" title="print"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">print</span></a><a href="http://blog.theaccidentalgeek.com/post/2010/12/01/Occams-Razor-and-DotNetNuke.aspx#about" title="?"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">?</span></a></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">001</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@using</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Security.Roles</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">002</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@using</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Entities.Users</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">003</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@using</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Common.Utilities</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">004</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@using</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Common</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">005</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@using</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Entities.Profile</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">006</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@using</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Entities.Portals</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">007</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">008</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@{ </span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">009</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;var
  teamImageDir = Href(Dnn.Portal.HomeDirectory) + "teamImages";</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">010</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;var
  users = (new</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">RoleController()).GetUsersByRoleName(Dnn.Portal.PortalId,
  "Coreteam");</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">011</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">012</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">013</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&lt;h2&gt;Razor
  CoreTeam Contacts Example&lt;/h2&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">014</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">015</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@foreach</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(UserInfo user in</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">users)</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">016</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">{</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">017</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&lt;div
  class="teammember"&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">018</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&lt;div
  class="teamheader clearfix"&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">019</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img
  class="profilephoto"</span><span style="font-size:12.0pt;
  font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;
  font-family:&quot;Courier New&quot;">style="width:120px;height:120px"</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">src="@GetProfileUrl(user.Profile)"</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">alt="Profile Photo
  for @user.DisplayName"</span><span style="font-size:12.0pt;font-family:
  &quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:
  &quot;Courier New&quot;">/&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">020</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div
  class="organization"&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">021</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h2&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">022</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a
  href="@Globals.UserProfileURL(user.UserID)"</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&gt;@user.DisplayName&lt;/a&gt;
  </span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">023</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "Country", "&lt;span class=\"country\"&gt;( {0}
  )&lt;/span&gt;")</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">024</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/h2&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">025</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "CompanyName", "&lt;div
  class=\"company\"&gt;{0}&lt;/div&gt;")</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">026</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "JobTitle", "&lt;div
  class=\"title\"&gt;{0}&lt;/div&gt;")</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">027</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "Website", "&lt;div class=\"website\"&gt;&lt;span
  class=\"NormalBold\"&gt;Website: &lt;/span&gt;&lt;a
  href=\"{0}\"&gt;{0}&lt;/a&gt;&lt;/div&gt;")</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">028</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">029</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div
  class="social"&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">030</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div
  class="legend"&gt;Community Network&lt;/div&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">031</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div
  class="community"&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">032</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;span
  class="NormalBold"&gt;DotNetNuke Username:
  &lt;/span&gt;@user.Username&lt;/div&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">033</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">034</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var
  personalblog = GetProfileProperty(user.Profile, "PersonalBlog");</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">035</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var
  dotnetnukeblog = GetProfileProperty(user.Profile,
  "DotNetNukeBlog");</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">036</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">037</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(personalblog !=
  string.Empty || dotnetnukeblog != string.Empty)</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">038</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">039</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;span
  class="NormalBold"&gt;Blogs: &lt;/span&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">040</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "PersonalBlog", "&lt;a href=\"{0}\" &gt;Personal
  Blog&lt;/a&gt;")@((personalblog != string.Empty &amp;&amp; dotnetnukeblog
  != string.Empty) ? ", "</span><span style="font-size:12.0pt;
  font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;
  font-family:&quot;Courier New&quot;">: string.Empty )</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">041</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "DotNetNukeBlog", "&lt;a href=\"{0}\" &gt;DotNetNuke
  Blog&lt;/a&gt;")</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">042</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">043</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">044</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">045</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div
  class="socialmedia"&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">046</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "FacebookUrl", "&lt;a href=\"{0}\" &gt;&lt;img
  src=\""</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">+
  teamImageDir + "/fb.png\" /&gt; Facebook&lt;/a&gt;")</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">047</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "LinkedInUrl", "&lt;a href=\"{0}\" &gt;&lt;img
  src=\""</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">+
  teamImageDir + "/li.png\" /&gt; LinkedIn&lt;/a&gt;")</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">048</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "TwitterUrl", "&lt;a href=\"{0}\" &gt;&lt;img
  src=\""</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">+
  teamImageDir + "/tw.png\" /&gt; Twitter&lt;/a&gt;")</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">049</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">050</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">051</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">052</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">053</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;@GetFormattedProfileProperty(user.Profile,
  "Biography", "&lt;div
  class=\"bio\"&gt;&lt;h2&gt;About
  Me&lt;/h2&gt;{0}&lt;/div&gt;")</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">054</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">055</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&lt;/div&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">056</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">057</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">@functions {</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">058</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;public</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">static</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">GetProfileUrl(UserProfile
  profile)</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">059</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">060</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">strPhotoURL =
  Globals.ApplicationPath + "/images/no_avatar.gif";</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">061</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;ProfilePropertyDefinition
  objProperty = profile.GetProperty("Photo");</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">062</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(objProperty != null</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&amp;&amp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">063</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string.IsNullOrEmpty(objProperty.PropertyValue)
  == false</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&amp;&amp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">064</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objProperty.Visibility
  == UserVisibilityMode.AllUsers)</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">065</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">066</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DotNetNuke.Services.FileSystem.FileController
  objFiles = new</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">DotNetNuke.Services.FileSystem.FileController();</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">067</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DotNetNuke.Services.FileSystem.FileInfo
  objFile = objFiles.GetFileById(int.Parse(objProperty.PropertyValue),
  objProperty.PortalId);</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">068</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">069</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//
  There is a bug in the Photo profile property that stores the host photo </span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">070</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//
  in the Current Portal and not in the host portal (-1). To overcome this </span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">071</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//
  bug we just look in the current Portal if we can't find a photo in the
  Profile Portal</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">072</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(objFile == null)</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">073</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">074</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objFile
  = objFiles.GetFileById(int.Parse(objProperty.PropertyValue),
  objProperty.PortalId);</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">075</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">076</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">077</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(objFile != null)</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">078</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">079</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PortalInfo
  objPortal = (new</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">PortalController()).GetPortal(objFile.PortalId);</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">080</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(objPortal != null)</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">081</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">082</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strPhotoURL
  = string.Format("{0}/{1}/{2}", Globals.ApplicationPath,
  objPortal.HomeDirectory, objFile.RelativePath);</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">083</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">084</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">085</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">086</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">strPhotoURL;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">087</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">088</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">089</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;public</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">static</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">GetProfileProperty(UserProfile
  profile, string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">propertyName)</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">090</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">091</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;ProfilePropertyDefinition
  objProperty = profile.GetProperty(propertyName);</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">092</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(objProperty == null</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">||
  string.IsNullOrEmpty(objProperty.PropertyValue)) return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string.Empty;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">093</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">094</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">objProperty.PropertyValue;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">095</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">096</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">097</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;public</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">static</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">GetFormattedProfileProperty(UserProfile
  profile, string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">propertyName,
  string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">
  </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">tagformat)</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">098</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">099</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;string</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">propertyval =
  GetProfileProperty(profile, propertyName);</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">100</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;if</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(propertyval !=
  string.Empty)</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">101</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;{</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">102</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string.Format(tagformat,
  @propertyval);</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">103</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">104</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">105</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;return</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"> </span><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">string.Empty;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">106</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;
display:none">&nbsp;</span></p>

<table class="MsoNormalTable" border="0" cellpadding="0">
 <tbody><tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">107</span></p>
  </td>
  <td colspan="2" style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">108</span></p>
  </td>
  <td style="padding: 0.75pt;">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">}</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Once you break the script down, you will
see that there is not a lot of code here.&nbsp; Most of it is needed to get
around a bug in DotNetNuke 5.6.0 for the PhotoURL profile property which does
not seem to work correctly with virtual directories.&nbsp; Below are the links
for the full script, css and images for the contact list, and a link to the
Razor Host Module beta.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In my next razor post, I’ll show how I
take this script, associated CSS and images and turn it into a full blown
DotNetNuke module.</span></p>

<h2><a href="http://www.charlesnurse.com/post/WebPages-and-Razor-3-Razor-syntax.aspx">Razor
and WebPages – 3 – Razor syntax</a></h2>

<p>What are WebPages and Razor – how do we (ASP.NET developers) use them to
build Web Applications.&nbsp; This is the subject of this series of
articles.&nbsp; In <a href="http://www.charlesnurse.com/post/Razor-and-WebPages-1-A-New-Way-to-Create-Web-Applications.aspx">part
1</a> I described how you can use WebMatrix to build a simple site using the
new CSHTML file type, and in <a href="http://www.charlesnurse.com/post/Razor-and-WebPages-2-The-Almighty-at.aspx">part
2</a> I introduced the new Razor syntax and how it compares with the syntax
used in ASP.NET WebForms.&nbsp; In this article I will dive deeper into the new
Syntax.</p>

<h2>The @ Operator</h2>

<p>In the previous article I focused on the <span style="background:yellow">@</span>
operator and how it used by the Razor parser to switch from markup (HTML) to
code (C# or VB.NET).</p>

<p>Razor understands C# (and VB.NET) syntax so it is able to support the
various language constructs.&nbsp; Figures 1-3 show 3 simple C# constructs and how
they would work in Razor.</p>

<table class="MsoNormalTable" style="width: 538.2pt;" width="718" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 444.45pt; padding: 3.75pt;" valign="top" width="593">
  <h3><em>Figure 1 – Inline Expressions</em></h3>
  </td>
  <td style="border: medium none; padding: 0cm;" colspan="2" width="110"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td style="width: 444.45pt; padding: 3.75pt;" valign="top" width="593">
  <p class="MsoNormal"><img id="Picture 9" src="DNNandRazor_files/image005.gif" alt="Razor_Syntax_03" width="532" border="0" height="112"></p>
  </td>
  <td style="border: medium none; padding: 0cm;" colspan="2" width="110"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td colspan="2" style="width: 472.95pt; padding: 3.75pt;" valign="top" width="631">
  <h3><em>Figure 2 – Single Statement Blocks</em></h3>
  </td>
  <td style="border: medium none; padding: 0cm;" width="72"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td colspan="2" style="width: 472.95pt; padding: 3.75pt;" valign="top" width="631">
  <p class="MsoNormal"><img id="Picture 10" src="DNNandRazor_files/image006.gif" alt="Razor_Syntax_04" width="360" border="0" height="100"></p>
  </td>
  <td style="border: medium none; padding: 0cm;" width="72"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td colspan="3" style="width: 530.8pt; padding: 3.75pt;" valign="top" width="708">
  <h3><em>Figure 3 – Multiple Statement Blocks</em></h3>
  </td>
 </tr>
 <tr>
  <td colspan="3" style="width: 530.8pt; padding: 3.75pt;" valign="top" width="708">
  <p class="MsoNormal"><img id="Picture 11" src="DNNandRazor_files/image007.gif" alt="Razor_Syntax_05" width="598" border="0" height="125"></p>
  </td>
 </tr>
 <tr height="0">
  <td style="border: medium none;" width="600"></td>
  <td style="border: medium none;" width="38"></td>
  <td style="border: medium none;" width="80"></td>
 </tr>
</tbody></table>

<p>Note that when using single or multiple statement blocks that the C# “{}”
braces are used to surround the code.</p>

<p>Once you are inside a block of C# code then anything that is valid C# is
allowed to be used such as for loops, while statements and if else statements.</p>

<p>As mentioned in the previous article the Razor parser is smart and as long
as the intention is clear can detect when switching back to markup, so the code
in Figure 4 is valid.&nbsp; As the code in line 25 ends with a “;” and the code
which starts line 26 is not valid C# the parser automatically switches back to
markup and recognizes the &lt;p&gt; tag.</p>

<table class="MsoNormalTable" style="width: 336.75pt;" width="449" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr style="height: 13.1pt;">
  <td style="width: 329.35pt; padding: 3.75pt; height: 13.1pt;" valign="top" width="439">
  <h3><em>Figure 4 – Automatic detection of markup</em></h3>
  </td>
 </tr>
 <tr style="height: 113.55pt;">
  <td style="width: 329.35pt; padding: 3.75pt; height: 113.55pt;" valign="top" width="439">
  <p class="MsoNormal"><img id="Picture 12" src="DNNandRazor_files/image008.gif" alt="Razor_Syntax_06" width="351" border="0" height="167"></p>
  </td>
 </tr>
</tbody></table>

<p>&nbsp;</p>

<h2>The @: Operator and &lt;text&gt;&lt;/text&gt; Tag</h2>

<p>If it cannot be made clear that the intention is to switch back to markup
then there are two ways you can indicate that the following text should be
considered markup, – the @: Operator and the &lt;text&gt; tag.</p>

<p>The @: Operator can be used in code to indicate that the rest of the line is
text or markup. (see Figure 5)</p>

<table class="MsoNormalTable" style="width: 314.25pt;" width="419" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr style="height: 10.6pt;">
  <td style="width: 306.85pt; padding: 3.75pt; height: 10.6pt;" valign="top" width="409">
  <h3><em>Figure 5 – Using the @: Operator</em></h3>
  </td>
 </tr>
 <tr style="height: 77.1pt;">
  <td style="width: 306.85pt; padding: 3.75pt; height: 77.1pt;" valign="top" width="409">
  <p class="MsoNormal"><img id="Picture 13" src="DNNandRazor_files/image009.gif" alt="Razor_Syntax_07" width="377" border="0" height="104"></p>
  </td>
 </tr>
</tbody></table>

<p>In this example, the @: operator forces Razor to switch back to markup
mode.&nbsp; Without the @: operator the Razor parser assumes this is C#
(although not valid), because it knows it is not a valid markup tag.</p>

<p>The &lt;text&gt;&lt;/text&gt; tag is a pseudo markup tag that identifies
everything between the opening and closing elements as text.&nbsp; It is most
useful when the content stretches over more than one line. (see Figure 6)</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <h3><em>Figure 6 – Using the &lt;text&gt;&lt;/text&gt; Tag</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 14" src="DNNandRazor_files/image010.gif" alt="Razor_Syntax_08" width="480" border="0" height="102"></p>
  </td>
 </tr>
</tbody></table>

<p>Note that once inside the pseudo-markup the @ operator still switches into
code – the &lt;text&gt; element is treated the same as any markup tag – it is
just ignored as real markup.</p>

<h2>Comments - The @* and *@ Operators</h2>

<p>Although Razor has a limited syntax, just like any other syntax it may be
necessary to place comments in Razor code.&nbsp; If we are in markup then the
standard &lt;!-- --&gt; syntax is used to add comments to markup which are not
rendered in the browser.&nbsp; If we are in code then the standard //&nbsp; or
/* */ syntax is used to add comments to the C# code, which is ignored by the C#
compiler.&nbsp; </p>

<p>In addition Razor provides its own comments which are ignored by the Razor
parser.</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <h3><em>Figure 7 – Razor comments</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 15" src="DNNandRazor_files/image011.gif" alt="Razor_Syntax_09" width="257" border="0" height="85"></p>
  </td>
 </tr>
</tbody></table>

<p>That’s it – that’s all you need to know to write your own Razor code.&nbsp;
of course you need to understand HTML markup and a programming language
supported by Razor (currently C# and VB.NET), but that is beyond the scope of
this article.</p>

<h3><a href="http://www.charlesnurse.com/post/WebPages-and-Razor-3-Razor-syntax.aspx">Razor
and WebPages – 3 – Razor syntax</a></h3>

<p>What are WebPages and Razor – how do we (ASP.NET developers) use them to
build Web Applications.&nbsp; This is the subject of this series of
articles.&nbsp; In <a href="http://www.charlesnurse.com/post/Razor-and-WebPages-1-A-New-Way-to-Create-Web-Applications.aspx">part
1</a> I described how you can use WebMatrix to build a simple site using the
new CSHTML file type, and in <a href="http://www.charlesnurse.com/post/Razor-and-WebPages-2-The-Almighty-at.aspx">part
2</a> I introduced the new Razor syntax and how it compares with the syntax
used in ASP.NET WebForms.&nbsp; In this article I will dive deeper into the new
Syntax.</p>

<h2>The @ Operator</h2>

<p>In the previous article I focused on the <span style="background:yellow">@</span>
operator and how it used by the Razor parser to switch from markup (HTML) to
code (C# or VB.NET).</p>

<p>Razor understands C# (and VB.NET) syntax so it is able to support the
various language constructs.&nbsp; Figures 1-3 show 3 simple C# constructs and
how they would work in Razor.</p>

<table class="MsoNormalTable" style="width: 538.2pt;" width="718" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 444.45pt; padding: 3.75pt;" valign="top" width="593">
  <h3><em>Figure 1 – Inline Expressions</em></h3>
  </td>
  <td style="border: medium none; padding: 0cm;" colspan="2" width="110"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td style="width: 444.45pt; padding: 3.75pt;" valign="top" width="593">
  <p class="MsoNormal"><img id="Picture 23" src="DNNandRazor_files/image012.gif" alt="Razor_Syntax_03" width="381" border="0" height="80"></p>
  </td>
  <td style="border: medium none; padding: 0cm;" colspan="2" width="110"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td colspan="2" style="width: 469.3pt; padding: 3.75pt;" valign="top" width="626">
  <h3>&nbsp;<em>Figure 2 – Single Statement Blocks</em></h3>
  </td>
  <td style="border: medium none; padding: 0cm;" width="77"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td colspan="2" style="width: 469.3pt; padding: 3.75pt;" valign="top" width="626">
  <p class="MsoNormal"><img id="Picture 24" src="DNNandRazor_files/image013.gif" alt="Razor_Syntax_04" width="176" border="0" height="49"></p>
  </td>
  <td style="border: medium none; padding: 0cm;" width="77"><p class="MsoNormal">&nbsp;</p></td>
 </tr>
 <tr>
  <td colspan="3" style="width: 530.8pt; padding: 3.75pt;" valign="top" width="708">
  <h3><em>Figure 3 – Multiple Statement Blocks</em></h3>
  </td>
 </tr>
 <tr>
  <td colspan="3" style="width: 530.8pt; padding: 3.75pt;" valign="top" width="708">
  <p class="MsoNormal"><img id="Picture 25" src="DNNandRazor_files/image014.gif" alt="Razor_Syntax_05" width="429" border="0" height="90"></p>
  </td>
 </tr>
 <tr height="0">
  <td style="border: medium none;" width="600"></td>
  <td style="border: medium none;" width="33"></td>
  <td style="border: medium none;" width="84"></td>
 </tr>
</tbody></table>

<p>Note that when using single or multiple statement blocks that the C# “{}”
braces are used to surround the code.</p>

<p>Once you are inside a block of C# code then anything that is valid C# is
allowed to be used such as for loops, while statements and if else statements.</p>

<p>As mentioned in the previous article the Razor parser is smart and as long
as the intention is clear can detect when switching back to markup, so the code
in Figure 4 is valid.&nbsp; As the code in line 25 ends with a “;” and the code
which starts line 26 is not valid C# the parser automatically switches back to
markup and recognizes the &lt;p&gt; tag.</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <h3><em>Figure 4 – Automatic detection of markup</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 26" src="DNNandRazor_files/image015.gif" alt="Razor_Syntax_06" width="200" border="0" height="95"></p>
  </td>
 </tr>
</tbody></table>

<h2>The @: Operator and &lt;text&gt;&lt;/text&gt; Tag</h2>

<p>If it cannot be made clear that the intention is to switch back to markup
then there are two ways you can indicate that the following text should be
considered markup, – the @: Operator and the &lt;text&gt; tag.</p>

<p>The @: Operator can be used in code to indicate that the rest of the line is
text or markup. (see Figure 5)</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <h3><em>Figure 5 – Using the @: Operator</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 27" src="DNNandRazor_files/image016.gif" alt="Razor_Syntax_07" width="345" border="0" height="95"></p>
  </td>
 </tr>
</tbody></table>

<p>In this example, the @: operator forces Razor to switch back to markup
mode.&nbsp; Without the @: operator the Razor parser assumes this is C#
(although not valid), because it knows it is not a valid markup tag.</p>

<p>The &lt;text&gt;&lt;/text&gt; tag is a pseudo markup tag that identifies
everything between the opening and closing elements as text.&nbsp; It is most
useful when the content stretches over more than one line. (see Figure 6)</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <h3><em>Figure 6 – Using the &lt;text&gt;&lt;/text&gt; Tag</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 28" src="DNNandRazor_files/image017.gif" alt="Razor_Syntax_08" width="401" border="0" height="85"></p>
  </td>
 </tr>
</tbody></table>

<p>Note that once inside the pseudo-markup the @ operator still switches into
code – the &lt;text&gt; element is treated the same as any markup tag – it is
just ignored as real markup.</p>

<h2>Comments - The @* and *@ Operators</h2>

<p>Although Razor has a limited syntax, just like any other syntax it may be
necessary to place comments in Razor code.&nbsp; If we are in markup then the
standard &lt;!-- --&gt; syntax is used to add comments to markup which are not
rendered in the browser.&nbsp; If we are in code then the standard //&nbsp; or
/* */ syntax is used to add comments to the C# code, which is ignored by the C#
compiler.&nbsp; </p>

<p>In addition Razor provides its own comments which are ignored by the Razor
parser.</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <h3><em>Figure 7 – Razor comments</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 29" src="DNNandRazor_files/image018.gif" alt="Razor_Syntax_09" width="257" border="0" height="85"></p>
  </td>
 </tr>
</tbody></table>

<p>That’s it – that’s all you need to know to write your own Razor code.&nbsp;
of course you need to understand HTML markup and a programming language
supported by Razor (currently C# and VB.NET), but that is beyond the scope of
this article.</p>

<h2>WebMatrix and DNN – 4 – Using Razor Scripts in DotNetNuke </h2>

<p>WebMatrix is Microsoft’s new suite of technologies designed to make creating
websites easier.&nbsp; There are four major components to the new WebMatrix
“Web Stack”</p>

<ol start="1" type="1">
 <li class="MsoNormal" style="line-height:normal"><a href="http://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx">IIS
     Developer Express</a> – a new free lightweight web-server, based on IIS 7,
     that runs on all versions of Windows and does not require Administrator
     level permissions </li>
 <li class="MsoNormal" style="line-height:normal"><a href="http://weblogs.asp.net/scottgu/archive/2010/06/30/new-embedded-database-support-with-asp-net.aspx">SQL
     Server Compact Edition</a> – a lightweight file based database that is
     simple to set up and free to download. </li>
 <li class="MsoNormal" style="line-height:normal"><a href="http://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx">ASP.NET
     “Razor”</a> – a new&nbsp; view-engine option for ASP.NET that can be used
     to easily embed C# or VB code within an HTML page. This is “bin”
     deployable and free. </li>
 <li class="MsoNormal" style="line-height:normal"><a href="http://weblogs.asp.net/scottgu/archive/2010/07/06/introducing-webmatrix.aspx">WebMatrix
     Tool</a> – a free lightweight developer IDE that integrates all the
     components. </li>
</ol>

<p>In previous articles in this series I described how the WebMatrix IDE can be
used to <a href="http://www.dotnetnuke.com/Community/Blogs/tabid/825/EntryId/2689/WebMatrix-and-DNN-1-Using-WebMatrix-to-Setup-Your-DotNetNuke-Site.aspx">Setup</a>,
<a href="http://www.dotnetnuke.com/Community/Blogs/tabid/825/EntryId/2752/WebMatrix-and-DNN-2-Using-WebMatrix-to-Publish-Your-DotNetNuke-Site.aspx">Publish</a>
and <a href="http://www.dotnetnuke.com/Community/Blogs/tabid/825/EntryId/2760/WebMatrix-and-DNN-3-Using-WebMatrix-to-Update-Your-DotNetNuke-Site.aspx">Update</a>
your DotNetNuke website.&nbsp; </p>

<p>In this article I turn to another component of the WebMatrix suite – the
Razor scripting engine and ASP.NET WebPages, and how we can use these
components in DotNetNuke.</p>

<h2>ASP.NET WebPages and Razor</h2>

<p>First lets take a quick look at WebPages and Razor.&nbsp; In ASP.NET
WebForms – the technology used for DotNetNuke, most of the time we keep our
HTML and our code separate – the HTML in “MyControl.ascx” and the code in
“MyControl.ascx.vb”, but sometimes we find ourselves writing snippets of code
directly in the HTML – because it is so much quicker (and easier).</p>

<table class="MsoNormalTable" style="width: 451.5pt;" width="602" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <h3><em>Figure 1 – Inline Code in FileManager.ascx</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <p class="MsoNormal"><img id="Picture 38" src="DNNandRazor_files/image019.jpg" alt="Razor_Syntax_01" width="599" border="0" height="90"></p>
  </td>
 </tr>
</tbody></table>

<p>The &lt;% … %&gt; delimiters – nicknamed&nbsp; “bumble-bees”, because of
their default syntax highlighting - are used to switch from HTML to code and
vice-versa.&nbsp; The parser is not smart – and requires the delimiters to
switch back and forth.</p>

<p>Razor simplifies this HTML &lt;—&gt; code switching.&nbsp; It uses a single
character to switch from HTML to code the “@” symbol, and by being much smarter
a delimiter to return to HTML is often not necessary.</p>

<table class="MsoNormalTable" style="width: 300pt;" width="400" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 187pt; padding: 1.5pt;" valign="top" width="249">
  <h3><em>Figure 2 – Example Razor Code</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 187pt; padding: 1.5pt;" valign="top" width="249">
  <p class="MsoNormal"><img id="Picture 39" src="DNNandRazor_files/image020.jpg" alt="Razor_Syntax_02" width="243" border="0" height="100"></p>
  </td>
 </tr>
</tbody></table>

<p>Note that we only have 5 “@”&nbsp; signs in this block of Razor code&nbsp; -
this is because Razor is smart enough that once a statement is complete e.g..
after @row.Username – if the next character is not valid C# it assumes that it
must be HTML, and switches context.&nbsp; Likewise the parser is smart enough to
know that if we start a C# block with “{“ then at some later stage we will want
to close it with “}” so the closing “}” does not need delimiting.</p>

<p>So that’s Razor – in future blogs I will dive deeper into Razor
syntax.&nbsp; But how can we use Razor scripts in DotNetNuke.</p>

<p>Well the answer lies in the second piece of the puzzle – ASP.NET
WebPages.&nbsp; This is a new lightweight WebPage Framework that uses the Razor
syntax.&nbsp; An ASP.NET WebPage is a “cshtml” – C# or vbhtml – VB.NET file
that uses Razor syntax.</p>

<p>We can use the WebPage Framework to load a Razor script file, parse it and
return the resulting HTML.</p>

<h2>The Razor Host Module</h2>

<p>In addition to the new bits that are available as part of the WebMatrix
suite, the Razor parser and the new WebPages Framework requires ASP.NET
4.0.&nbsp; As we still wish to retain compatibility with ASP.NET 3.5 we cannot
directly integrate support for Razor scripts into DotNetNuke.</p>

<p>Therefore, our approach to providing support for Razor scripts is to provide
a “Razor Host” module.&nbsp; If DotNetNuke users wish to use Razor scripts as
part of their sites, they will need to install this module.</p>

<p>A Beta of this module will be available this month, based on the current
WebMatrix Beta.</p>

<p>An instance of this module can be added to a page in the usual way by
selecting it from the Ribbon Bar (see Figure 3)</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 279.6pt; padding: 1.5pt;" valign="top" width="373">
  <h3><em>Figure 3 – Adding a Razor Host Module to a Page</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 279.6pt; padding: 1.5pt;" valign="top" width="373">
  <p class="MsoNormal"><img id="Picture 40" src="DNNandRazor_files/image021.jpg" alt="Razor_Module_01" width="196" border="0" height="192"></p>
  </td>
 </tr>
</tbody></table>

<p>The resulting Module will look like this (Figure 4)</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <h3><em>Figure 4 – Razor Host Module on a Page</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <p class="MsoNormal"><img id="Picture 41" src="DNNandRazor_files/image022.jpg" alt="Razor_Module_02" width="213" border="0" height="55"></p>
  </td>
 </tr>
</tbody></table>

<p>The Razor Host Module is capable of displaying any Razor script that is
provided to it.&nbsp; The script can be selected in the Module Settings (Figure
5).</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <h3><em>Figure 5 – Selecting the Script to Display</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <p class="MsoNormal"><img id="Picture 42" src="DNNandRazor_files/image023.jpg" alt="Razor_Module_03" width="181" border="0" height="99"></p>
  </td>
 </tr>
</tbody></table>

<p>Here you can select one of the Scripts available.&nbsp; In this case, I have
selected the “PageInfo.cshtml” script, which displays information about the
current Page.&nbsp; Once you have selected a script, and clicked Update the
“Host” Module will process the script and render its results.</p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <h3><em>Figure 6 – The Rendered Razor Script</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 280.5pt; padding: 1.5pt;" valign="top" width="374">
  <p class="MsoNormal"><img id="Picture 43" src="DNNandRazor_files/image024.jpg" alt="Razor_Module_04" width="219" border="0" height="86"></p>
  </td>
 </tr>
</tbody></table>

<p>So that’s how we can select a previously created script, but how can we edit
or create scripts.&nbsp; You will notice that when a user with Edit rights is
logged in that there is an “Edit Script” Action Button (which is also available
on the Action menu).&nbsp; Selecting this Action will bring up the “Edit
Script” control (Figure 7).</p>

<table class="MsoNormalTable" style="width: 133.35pt;" width="178" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr style="height: 5.2pt;">
  <td style="width: 133.35pt; padding: 1.5pt; height: 5.2pt;" valign="top" width="178">
  <h3><em>Figure 7 – The Edit Script Control</em></h3>
  </td>
 </tr>
 <tr style="height: 111.1pt;">
  <td style="width: 133.35pt; padding: 1.5pt; height: 111.1pt;" valign="top" width="178">
  <p class="MsoNormal"><a href="http://www.dotnetnuke.com/Portals/25/Blog/Files/15/2857/Windows-Live-Writer-WebMatrix-and-DNN_E8EC-Razor_Module_05_2.png"><span style="text-decoration:none"><img id="Picture 44" src="DNNandRazor_files/image025.jpg" alt="Razor_Module_05" width="173" border="0" height="115"></span></a></p>
  </td>
 </tr>
</tbody></table>

<p>This control allows you to:</p>

<ol start="1" type="1">
 <li class="MsoNormal" style="line-height:normal">Add a new Script File </li>
 <li class="MsoNormal" style="line-height:normal">Choose a Script file to Edit. </li>
 <li class="MsoNormal" style="line-height:normal">Modify the Script source in the
     Text Area. </li>
 <li class="MsoNormal" style="line-height:normal">Set the current Script to be
     the Active Script (Is Active) – as an alternative to choosing the “Active”
     script in the Module Settings. </li>
 <li class="MsoNormal" style="line-height:normal">Save the Modified Script. </li>
</ol>

<p>The script files are all stored in the “Scripts” sub-folder.</p>

<p>The Text Area does not provide any Syntax Highlighting (or Syntax
checking).&nbsp; But if you want some “Syntax Highlighting” you can use the
WebMatrix IDE to modify the script files (Figure 8).</p>

<table class="MsoNormalTable" style="width: 362.25pt;" width="483" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr style="height: 6.25pt;">
  <td style="width: 362.25pt; padding: 1.5pt; height: 6.25pt;" valign="top" width="483">
  <h3><em>Figure 8 – Editing a Razor Script in WebMatrix</em></h3>
  </td>
 </tr>
 <tr style="height: 78.85pt;">
  <td style="width: 362.25pt; padding: 1.5pt; height: 78.85pt;" valign="top" width="483">
  <p class="MsoNormal"><img id="Picture 45" src="DNNandRazor_files/image026.jpg" alt="Razor_Module_06" width="401" border="0" height="176"></p>
  </td>
 </tr>
</tbody></table>

<p>Note that the C# code has a different highlighting than the HTML.</p>

<h2>What’s Next?</h2>

<p>As mentioned earlier in this blog, this prototype module will be made
available for separate download soon, so you will be able to start writing your
own Razor scripts (or using scripts provided by others).&nbsp; </p>

<p>Microsoft will be providing a number of Helper methods to simplify common
Web tasks, such as using a Gravatar, displaying a Twitter Feed, or sending an
email, and we will do the same to provide Razor script writers access to the
DotNetNuke API.</p>

<p>Over the next few weeks (and months) we will be enhancing this module so
that when the final RTW version of WebMatrix ships we will be able to provide
an “out-of-the-box” solution to allow users to take advantage of this new
technology.</p>

<h2><a href="http://www.charlesnurse.com/post/WebMatrix-and-DNN-5-Hosting-the-Razor-Engine.aspx">WebMatrix
and DNN – 5 – Hosting the Razor Engine</a></h2>

<p>In my <a href="http://www.charlesnurse.com/post/WebMatrix-and-DNN-4-Using-Razor-Scripts-in-DotNetNuke.aspx">previous
post</a> in this series on the new WebMatrix suite of technologies from
Microsoft, I described how we are supporting the use of Razor scripts in
DotNetNuke, by providing a “Razor Host” module.&nbsp; In this article I will
dive deeper into how we host the Razor Parser.&nbsp;</p>

<p>Razor can actually be thought of as a templating engine and if you are
planning on building a module that requires templates you might want to
consider Razor.&nbsp; Hopefully, this article will show how you might do that.</p>

<h2>The WebPage Class</h2>

<p>The WebPage Class (actually WebPageBase) is the basis of the new WebPages
Framework, in the same way that the “Page” class is the basis of the WebForms
Framework.</p>

<p>Essentially the approach we use in our “Razor Host” module is as follows.</p>

<ol start="1" type="1">
 <li class="MsoNormal" style="line-height:normal">Identify the Razor script file
     (e.g. Twitter.cshtml) </li>
 <li class="MsoNormal" style="line-height:normal">Call BuildManager.GetType(scriptFile)
     to create an instance of WebPage.&nbsp; Note that the System.Web.WebPages
     assembly contains a special class – PreApplicationStartCode – that ensures
     that the extensions cshtml and vbhtml are registered with the BuildManager
     </li>
 <li class="MsoNormal" style="line-height:normal">Call the ExecutePageHierarchy
     method of the WebPage class and capture the rendered content. </li>
 <li class="MsoNormal" style="line-height:normal">Create a LiteralControl with
     the rendered content and add it to the control tree. </li>
</ol>

<p>In order to achieve this there are two new classes in a new assembly
(DotNetNuke.Web.Razor.dll) which is distributed as part of the “Razor Host”
Module.</p>

<ol start="1" type="1">
 <li class="MsoNormal" style="line-height:normal">RazorModuleBase – this class
     implements IModuleControl by sub-classing ModuleUserControlBase </li>
 <li class="MsoNormal" style="line-height:normal">DotNetNukeWebPage – this class
     subclasses WebPageBase and provides some DNN specific enhancements. </li>
</ol>

<h2>The RazorModuleBase Class</h2>

<p>The RazorModuleBase class is where everything comes together.&nbsp; All DNN
Modules need to implement the IModuleControl Interface – this how the module
injection logic knows what to inject.&nbsp; RazorModuleBase is a new base class
that implements IModuleControl and is used as the base class for the Razor Host
Module.</p>

<p>In the OnPreRender method of the class we first check if our script -
RazorScriptFile – exists.&nbsp; If it does we call the CreateWebPageInstance
method to get an instance of&nbsp; the DotNetNukeWebPage (lines 7-16)</p>

<table class="MsoNormalTable" style="width: 322.15pt;" width="430" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 515.25pt; padding: 1.5pt;" valign="top" width="687">
  <h3><em>Figure 1 – The OnPreRender method of the RazorModuleBase class</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 515.25pt; padding: 1.5pt;" valign="top" width="687"><pre><span class="lnum">&nbsp;&nbsp; 1:&nbsp; </span><span class="kwrd">Protected</span> <span class="kwrd">Overrides</span> <span class="kwrd">Sub</span> OnPreRender(<span class="kwrd">ByVal</span> e <span class="kwrd">As</span> System.EventArgs)</pre><pre><span class="lnum">&nbsp;&nbsp; 2:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">MyBase</span>.OnPreRender(e)</pre><pre><span class="lnum">&nbsp;&nbsp; 3:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp;&nbsp; 4:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Try</span></pre><pre><span class="lnum">&nbsp;&nbsp; 5:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">If</span> File.Exists(Server.MapPath(RazorScriptFile)) <span class="kwrd">Then</span></pre><pre><span class="lnum">&nbsp;&nbsp; 6:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp;&nbsp; 7:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Dim</span> instance <span class="kwrd">As</span> <span class="kwrd">Object</span> = CreateWebPageInstance()</pre><pre><span class="lnum">&nbsp;&nbsp; 8:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">If</span> instance <span class="kwrd">Is</span> <span class="kwrd">Nothing</span> <span class="kwrd">Then</span></pre><pre><span class="lnum">&nbsp;&nbsp; 9:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Throw</span> <span class="kwrd">New</span> InvalidOperationException( _</pre><pre><span class="lnum">&nbsp; 10:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">String</span>.Format( _</pre><pre><span class="lnum">&nbsp; 11:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CultureInfo.CurrentCulture, _</pre><pre><span class="lnum">&nbsp; 12:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="str">"The webpage found at '{0}' was not created."</span>, _</pre><pre><span class="lnum">&nbsp; 13:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RazorScriptFile))</pre><pre><span class="lnum">&nbsp; 14:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre><span class="lnum">&nbsp; 15:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp; 16:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Dim</span> webPage <span class="kwrd">As</span> DotNetNukeWebPage = <span class="kwrd">TryCast</span>(instance, DotNetNukeWebPage)</pre><pre><span class="lnum">&nbsp; 17:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp; 18:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">If</span> webPage <span class="kwrd">Is</span> <span class="kwrd">Nothing</span> <span class="kwrd">Then</span></pre><pre><span class="lnum">&nbsp; 19:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Throw</span> <span class="kwrd">New</span> InvalidOperationException( _</pre><pre><span class="lnum">&nbsp; 20:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">String</span>.Format( _</pre><pre><span class="lnum">&nbsp; 21:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CultureInfo.CurrentCulture,</pre><pre><span class="lnum">&nbsp; 22:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="str">"The webpage at '{0}' must derive from DotNetNukeWebPage."</span>,</pre><pre><span class="lnum">&nbsp; 23:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RazorScriptFile))</pre><pre><span class="lnum">&nbsp; 24:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre><span class="lnum">&nbsp; 25:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp; 26:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webPage.SetContext(<span class="kwrd">Me</span>.ModuleContext)</pre><pre><span class="lnum">&nbsp; 27:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitHelpers(webPage)</pre><pre><span class="lnum">&nbsp; 28:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp; 29:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Dim</span> writer <span class="kwrd">As</span> <span class="kwrd">New</span> StringWriter</pre><pre><span class="lnum">&nbsp; 30:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;webPage.ExecutePageHierarchy(<span class="kwrd">New</span> WebPageContext(HttpContext), writer, webPage)</pre><pre><span class="lnum">&nbsp; 31:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp; 32:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Controls.Add(<span class="kwrd">New</span> LiteralControl(Server.HtmlDecode(writer.ToString())))</pre><pre><span class="lnum">&nbsp; 33:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre><span class="lnum">&nbsp; 34:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Catch</span> ex <span class="kwrd">As</span> Exception</pre><pre><span class="lnum">&nbsp; 35:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessModuleLoadException(<span class="kwrd">Me</span>, ex)</pre><pre><span class="lnum">&nbsp; 36:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">End</span> <span class="kwrd">Try</span></pre><pre><span class="lnum">&nbsp; 37:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp; 38:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp; 39:&nbsp; </span><span class="kwrd">End</span> Sub</pre></td>
 </tr>
</tbody></table>

<p>We then set the WebPage’s module context by calling its SetContext method
(line 26).&nbsp; This allows us to access the ModuleContext in Razor
script.&nbsp; Finally we call the WebPage’s ExecutePageHierarchy method to get
the rendered content, which we add as a LiteralControl to the Controls
collection of the module.</p>

<p>In the above description I glossed over two important points: the
RazorScriptFile property and the CreateWebPageInstance property.</p>

<p>The RazorScriptFile property (Figure 2) returns the virtual path of a
“default” script file.&nbsp; In the Razor Host module, we override this
property and return the currently selected script, but the default behaviour in
the base class is to return “MyScript.cshtml” if the current control is
“MyScript.ascx”.</p>

<table class="MsoNormalTable" style="width: 280.5pt;" width="374" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <h3><em>Figure 2 - The RazorScriptFile property</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600"><pre><span class="lnum">&nbsp;&nbsp; 1:&nbsp; </span><span class="kwrd">Protected</span> <span class="kwrd">Overridable</span> <span class="kwrd">ReadOnly</span> <span class="kwrd">Property</span> RazorScriptFile <span class="kwrd">As</span> <span class="kwrd">String</span></pre><pre><span class="lnum">&nbsp;&nbsp; 2:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Get</span></pre><pre><span class="lnum">&nbsp;&nbsp; 3:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Return</span> <span class="kwrd">Me</span>.AppRelativeVirtualPath.Replace(<span class="str">"ascx"</span>, <span class="str">"cshtml"</span>)</pre><pre><span class="lnum">&nbsp;&nbsp; 4:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">End</span> <span class="kwrd">Get</span></pre><pre><span class="lnum">&nbsp;&nbsp; 5:&nbsp; </span><span class="kwrd">End</span> Property</pre></td>
 </tr>
</tbody></table>

<p>The CreateWebPageInstance method (Figure 3) uses the RazorScritpFile
property to create an instance of a DotNetNukeWebPage (Figure 3), calling
BuildManager.GetCompiledType (line 2), which returns a Type and then calling
Activator.CreateInstance (line6) to return an instance of the
DotNetNukeWebPage.</p>

<table class="MsoNormalTable" style="width: 280.5pt;" width="374" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <h3><em>Figure 3 – CreateWebPageInstance</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600"><pre><span class="lnum">&nbsp;&nbsp; 1:&nbsp; </span><span class="kwrd">Private</span> <span class="kwrd">Function</span> CreateWebPageInstance() <span class="kwrd">As</span> <span class="kwrd">Object</span></pre><pre><span class="lnum">&nbsp;&nbsp; 2:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Dim</span> type <span class="kwrd">As</span> Type = BuildManager.GetCompiledType(RazorScriptFile)</pre><pre><span class="lnum">&nbsp;&nbsp; 3:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Dim</span> instance <span class="kwrd">As</span> <span class="kwrd">Object</span> = <span class="kwrd">Nothing</span></pre><pre><span class="lnum">&nbsp;&nbsp; 4:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp;&nbsp; 5:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">If</span> type IsNot <span class="kwrd">Nothing</span> <span class="kwrd">Then</span></pre><pre><span class="lnum">&nbsp;&nbsp; 6:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instance = Activator.CreateInstance(type)</pre><pre><span class="lnum">&nbsp;&nbsp; 7:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">End</span> <span class="kwrd">If</span></pre><pre><span class="lnum">&nbsp;&nbsp; 8:&nbsp; </span>&nbsp;</pre><pre><span class="lnum">&nbsp;&nbsp; 9:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">Return</span> instance</pre><pre><span class="lnum">&nbsp; 10:&nbsp; </span><span class="kwrd">End</span> Function</pre></td>
 </tr>
</tbody></table>

<p>Earlier in this article I mentioned that BuildManager knew to “build” a
WebPage instance from a cshtml or vbhtml because of some code that exists in
the WebPages Framework that registers the extension.&nbsp; So why do we get an
instance of DotNetNukeWebPage rather than an instance of WebPage?&nbsp;</p>

<p>The answer lies&nbsp; in the included web.config file that sits in the same
folder as the Razor Host Module.&nbsp; By default the Razor Engine will return
an instance of WebPage, but this can be modified in the new
system.web.webPages.razor section of web.config, where we have indicated that
an instance of DotNetNukeWebPage should be returned.</p>

<table class="MsoNormalTable" style="width: 280.5pt;" width="374" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <h3><em>Figure 4 – Razor Host Module’s web.config file</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600"><pre><span class="lnum">&nbsp;&nbsp; 1:&nbsp; </span><span class="kwrd">&lt;</span><span class="html">system.web.webPages.razor</span><span class="kwrd">&gt;</span></pre><pre><span class="lnum">&nbsp;&nbsp; 2:&nbsp; </span>&nbsp;&nbsp;<span class="kwrd">&lt;</span><span class="html">pages</span> <span class="attr">pageBaseType</span><span class="kwrd">="DotNetNuke.Web.Razor.DotNetNukeWebPage"&gt;</span></pre><pre><span class="lnum">&nbsp;&nbsp; 3:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">&lt;</span><span class="html">namespaces</span><span class="kwrd">&gt;</span></pre><pre><span class="lnum">&nbsp;&nbsp; 4:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">&lt;</span><span class="html">add</span> <span class="attr">namespace</span><span class="kwrd">="Microsoft.Web.Helpers"</span> <span class="kwrd">/&gt;</span></pre><pre><span class="lnum">&nbsp;&nbsp; 5:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">&lt;</span><span class="html">add</span> <span class="attr">namespace</span><span class="kwrd">="WebMatrix.Data"</span> <span class="kwrd">/&gt;</span></pre><pre><span class="lnum">&nbsp;&nbsp; 6:&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwrd">&lt;/</span><span class="html">namespaces</span><span class="kwrd">&gt;</span></pre><pre><span class="lnum">&nbsp;&nbsp; 7:&nbsp; </span>&nbsp;&nbsp;<span class="kwrd">&lt;/</span><span class="html">pages</span><span class="kwrd">&gt;</span></pre><pre><span class="lnum">&nbsp;&nbsp; 8:&nbsp; </span><span class="kwrd">&lt;/</span><span class="html">system.web.webPages.razor</span><span class="kwrd">&gt;</span></pre></td>
 </tr>
</tbody></table>

<p>At the moment we are just including this web.config file as part of the
module, but in the final release we will probably update the web.config file in
the website root to include the information.</p>

<p>So that was for all the Architect types who want to know how it was
done.&nbsp; In the next blog I will show how you can “package” up a script you
have created and distribute it to other DNN users.</p>

<h2><a href="http://www.charlesnurse.com/post/WebMatrix-and-DNN-6-Distributing-Razor-Script-Modules.aspx">WebMatrix
and DNN – 6 – Distributing Razor Script Modules</a></h2>

<p>In an <a href="http://www.charlesnurse.com/post/WebMatrix-and-DNN-4-Using-Razor-Scripts-in-DotNetNuke.aspx">earlier
article</a> in this series on the new WebMatrix suite of technologies from
Microsoft, I described how we are supporting the use of Razor scripts in DotNetNuke,
by providing a “Razor Host” module.&nbsp;</p>

<p>Having created this cool new Razor script, how do you go about distributing
it?&nbsp;</p>

<p>In this article I will describe how you can package the script up as a
module.&nbsp; Using the initial prototype of the “Razor Host” module, some of
the steps are manual, but in a future iteration we expect to add a packaging
feature to the module to automate the process.</p>

<h2>Creating the Initial Script</h2>

<p>Obviously the first step is to create the script.&nbsp; In this example I am
going to use one of the scripts that are included with the Razor Host module –
Twitter.cshtml.</p>

<table class="MsoNormalTable" style="width: 280.5pt;" width="374" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <h3>Figure 1 – The Twitter.cshtml Script</h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 56" src="DNNandRazor_files/image027.jpg" alt="Razor_Module_01" width="321" border="0" height="297"></p>
  </td>
 </tr>
</tbody></table>

<h2>&nbsp;</h2>

<h2>Creating the Module</h2>

<p>The next step in the process is to “create” a new Module based on this
script.&nbsp; This is done by taking advantage of one of the properties in the
RazorModuleBase base class – RazorScriptFile.&nbsp; In my <a href="http://www.charlesnurse.com/post/WebMatrix-and-DNN-5-Hosting-the-Razor-Engine.aspx">previous
post</a> I showed that the default implementation of RazorScriptFile loads the
script file with the same name as the ascx file.</p>

<p>We therefore create a simple ascx file under DesktopModules for our
“Twitter” module (Figure 2)</p>

<table class="MsoNormalTable" style="width: 280.5pt;" width="374" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <h3><em>Figure 2 – Creating the Twitter Module</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <p class="MsoNormal"><a href="http://www.charlesnurse.com/image.axd?picture=Razor_Module_02_1.png"><span style="text-decoration:none"><img id="Picture 57" src="DNNandRazor_files/image028.jpg" alt="Razor_Module_02" width="481" border="0" height="140"></span></a></p>
  </td>
 </tr>
</tbody></table>

<p>In this example I have created a “Razor Modules” folder, and under that a
“Twitter” folder, where I have created the Twitter.ascx file and copied the
Twitter.cshtml script from my Razor Host Module.&nbsp; The ascx file is very
simple – it has a single line of code at the top of the file (which will be the
same for all Razor script modules).</p>

<p>&lt;%@ Control AutoEventWireup="false"
Inherits="DotNetNuke.Web.Razor.RazorModuleBase" %&gt;</p>

<p>By inheriting from the RazorModuleBase base class – and naming our ascx file
- Twitter.ascx, the RazorModuleBase base class automatically tries to load the
file - Twitter.cshtml.</p>

<p>So, we have “created” our module.&nbsp; The last step is to package it for
distribution.&nbsp; In order to package the module we need to register it in
our dnn development site.&nbsp; We can do this using the “Create New Module”
action under Host/Module Definitions (Figure 3), in exactly the same way as
Shaun Walker described in a <a href="http://www.dotnetnuke.com/Community/Blogs/tabid/825/EntryId/2832/Inline-Script-Module-Development-in-DotNetNuke.aspx">recent
blog on creating Modules</a>.</p>

<table class="MsoNormalTable" style="width: 327.25pt;" width="436" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 523.5pt; padding: 1.5pt;" valign="top" width="698">
  <h3><em>Figure 3 – Registering the Twitter Module in Module Definitions</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 523.5pt; padding: 1.5pt;" valign="top" width="698">
  <p class="MsoNormal"><img id="Picture 58" src="DNNandRazor_files/image029.jpg" alt="Razor_Module_03" width="371" border="0" height="292"></p>
  </td>
 </tr>
</tbody></table>

<p>Now we have registered the module we can package it using the built-in
packager – just as we can with any DotNetNuke module.</p>

<p>The packager automatically detects both the ascx file and the cshtml file
(Figure 4).</p>

<table class="MsoNormalTable" style="width: 280.5pt;" width="374" border="0" cellpadding="0" cellspacing="0">
 <tbody><tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <h3><em>Figure 4 – Packaging the Twitter Module</em></h3>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 1.5pt;" valign="top" width="600">
  <p class="MsoNormal"><img id="Picture 59" src="DNNandRazor_files/image030.jpg" alt="Razor_Module_04" width="265" border="0" height="99"></p>
  </td>
 </tr>
</tbody></table>

<p>The zip package created by the Packager can then be distributed to anyone
who has the Razor Host Module installed – the requirement for the presence of
the Razor Host module is that this module installs a number of dependent
assemblies that are necessary for Razor support to work.&nbsp; When we add
packaging to the Razor Host module itself this dependency will go away as we
will automatically include all the assemblies and files necessary to make the
module work.</p>

<h2><a href="http://www.charlesnurse.com/post/Razor-Tips-and-Tricks-1-Required-Assemblies.aspx">Razor
Tips and Tricks #1 – Required Assemblies</a></h2>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In this first post I will provide the
first Tip for anyone wanting to bundle their Razor Module for distribution to
users who do not have WebMatrix OR the Razor Host Module installed on their
machines.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">When you try and create a Package from
your Razor script using the Create Package Wizard, you are prompted for a list
of assemblies to include.&nbsp; Here is the complete List</span></p>

<ul type="disc">
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">DotNetNuke.Web.Razor.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Microsoft.Web.Helpers.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">System.Web.Helpers.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">System.Web.Razor.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">System.Web.WebPages.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">System.Web.WebPages.Razor.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">WebMatrix.Data.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">WebMatrix.WebData.dll </span></li>
 <li class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
     font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Microsoft.Web.Infrastructure.dll </span></li>
</ul>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Of course, you can leave these out of
you own package if you intend your users to have already installed the Razor
Host module.</span></p>

<h2><a href="http://www.charlesnurse.com/post/Razor-Tips-and-Tricks-2-Razors-Custom-webconfig-File.aspx">Razor
Tips and Tricks #2 – Razor’s Custom web.config File</a></h2>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In this second post I will provide some
information about the web.config file located in the RazorModules folder.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">One of the neat features of
Razor/WebPages is that the parser is highly configurable.&nbsp; Its
configuration is controlled by a new section in web.config (shown in Figure
1).&nbsp; In theory the section can be placed in the web.config file in the web
root, but as it is only of interest to Razor it can be placed in a custom
web.config file in DesktopModules.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">The file distributed with the Razor Host
module is installed into the ~/DesktopModules/RazorModules folder.</span></p>

<table class="MsoNormalTable" style="width: 280.5pt;" width="374" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 1 –&nbsp; Custom
  web.config file</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;
  &lt;system.web.webPages.razor&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;pages pageBaseType="DotNetNuke.Web.Razor.DotNetNukeWebPage"&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;namespaces&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;
  4:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;add namespace="Microsoft.Web.Helpers" /&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;
  5:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;add namespace="WebMatrix.Data" /&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 6:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;/namespaces&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 7:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;/pages&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 8:&nbsp;&nbsp;&nbsp;
  &lt;/system.web.webPages.razor&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">The entry on line 2 of the file tells
the Razor parser that the Razor base type is DotNetNukeWebPage (not WebPage),
and the namespaces nodes tell the parser to automatically “include” the
specified namespaces.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">If you want/need to use other namespaces
– maybe from helpers that you wrote yourself – or that you found on the
Internet - then adding the namespaces here means that you do not need “@using”
statements in the .cshtml file(s).</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">By convention, the RazorHost module is
installed in the RazorModules folder and as long as any other Razor module is
located in a subfolder of RazorModules then it will “inherit” the settings in
this custom web.config.&nbsp;</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">So, if you want to place your Razor
script somewhere else – say DesktopModules/MyModules then you will need to
deploy your own version of the web.config which contains the &lt;pages&gt; node
at the least.</span></p>

<h2><a href="http://www.charlesnurse.com/post/Razor-Tips-and-Tricks-3-Look-No-forms.aspx">Razor
Tips and Tricks #3 – “Look, No forms”</a></h2>

<p>In this third post I will cover a couple of caveats when using Razor scripts
in the DotNetNuke context.</p>

<h2>No Forms</h2>

<p>The first caveat is that because the Razor script is still running within
the context of a ASP.NET WebForm, you need to be careful when using Razor
scripts that you find (or write yourself) for collecting form data.&nbsp;
&lt;form&gt; tags cannot be embedded inside other form tags – and because an
ASP.NET WebForm (.aspx) always contain a &lt;form&gt; tag, this means that
Razor scripts used in the DotNetNuke context cannot contain &lt;form&gt; tags.</p>

<p>The workaround is simple – just remove the &lt;form&gt; tags from any Razor
script you use in DotNetNuke.&nbsp; Any submit button will post back as usual
and DotNetNuke will pass the Form variables to the script as normal.</p>

<h2>Urls</h2>

<p>The second caveat is that you should be careful with following Razor script
examples that use Urls.&nbsp; For example you will often see something like:</p>

<pre>@RenderPage(<span class="str">"/Shared/_Header.cshtml"</span>);</pre>

<p>The initial “/” means that we the url is starting at the web-root.&nbsp; As most
Razor examples you see will assume that your Razor script is executing in the
context of web-root – this example is fine.&nbsp; But in DotNetNuke, the Shared
directory would probably be buried deep in the website folder structure (for
example ~/DesktopModules/RazorModules/MyModule/Shared/).&nbsp;</p>

<p>In this case just leave out the initial “/” so that the url is relative.</p>

<pre>@RenderPage(<span class="str">"Shared/_Header.cshtml"</span>);</pre>

<p class="MsoNormal">&nbsp;</p>

<h2><a href="http://www.charlesnurse.com/post/Razor-Tips-and-Tricks-4-Extending-the-Helpers.aspx">Razor
Tips and Tricks #4 – Extending the Helpers</a></h2>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In this fourth post I will cover how you
can go about extending the provided helpers to provide a simpler API for the
scripts to consume.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">The DotNetNukeWebPage class, which is
the base class for all Razor scripts used in DotNetNuke has three additional
properties.</span></p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 1 – DotNetNukeWebPage
  Proeprties</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 1:&nbsp;
  Protected Friend Property Dnn As DnnHelper</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 2:&nbsp;
  Protected Friend Property Html As HtmlHelper</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 3:&nbsp;
  Protected Friend Property Url As UrlHelper</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In this tip we are going to extend the
Dnn property to add an extra method.&nbsp; The Dnn property is an instance of
the DnnHelper class which is defined in the DotNetNuke.Web.Razor library.</span></p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 2 - The DnnHelper Class</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 1:&nbsp;
  Public Class DnnHelper</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 2:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Private _context As ModuleInstanceContext</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 4:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 5:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Public Sub New(ByVal context As ModuleInstanceContext)</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;
  6:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _context = context</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 7:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  End Sub</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 8:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 9:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Public ReadOnly Property [Module] As ModuleInfo</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  10:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  11:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _context.Configuration</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  12:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 13:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  End Property</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 14:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 15:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Public ReadOnly Property Tab As TabInfo</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  16:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  17:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _context.PortalSettings.ActiveTab</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  18:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 19:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  End Property</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 20:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 21:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Public ReadOnly Property Portal As PortalSettings</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  22:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  23:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _context.PortalSettings</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  24:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 25:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  End Property</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 26:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 27:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Public ReadOnly Property User As UserInfo</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  28:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  29:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _context.PortalSettings.UserInfo</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  30:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 31:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  End Property</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 32:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 33:&nbsp; End
  Class</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Imagine that you want to write a script
which lists all of the roles on the site. You could use the full DotNetNuke API
in your Razor script as shown in Figure 3</span></p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 3 – Role List script</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"><img id="Picture 69" src="DNNandRazor_files/image031.gif" alt="RazorTips_01" width="414" border="0" height="214"></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">There is nothing wrong with this – it
works.&nbsp; But what if you could have a much simpler script to do the same
task (Figure 4).</span></p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 4 – Simplified Role List
  script</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"><img id="Picture 70" src="DNNandRazor_files/image032.gif" alt="RazorTips_02" width="266" border="0" height="133"></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">For beginner developers who are trying
their hand at DotNetNuke development using the Razor Host module, this is much
more intuitive.&nbsp; But GetRoles() is not a member of the DnnHelper class,
and I don’t want to modify a core class.&nbsp; This is where the wonders of
Extension methods comes in.&nbsp; Since C# 3 (or VB 9) which shipped with
Visual Studio 2008, we have been able to add functionality to existing classes,
without modifying the class directly.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In a separate project, I added a class
DnnHelperExtensions, where I defined the following extension method (Figure 5).</span></p>

<table class="MsoNormalTable" style="width: 562.5pt;" width="750" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 553.5pt; padding: 3.75pt;" valign="top" width="738">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 5 – GetRoles Extension
  Method</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 554.25pt; padding: 3.75pt;" valign="top" width="739">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 1:&nbsp;
  public static class DnnHelperExtensions</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 2:&nbsp; {</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  public static List&lt;String&gt; GetRoles(this DnnHelper helper)</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 4:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;
  5:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var controller = new RoleController();</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;
  6:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var _roles = new List&lt;String&gt;(controller.GetRoleNames(</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;

  
7:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 helper.Portal.PortalId</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;

  
8:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 ));</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 9:&nbsp;
  &nbsp;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;
  10:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _roles;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 11:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp; 12:&nbsp; }</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">This method hides the DotNetNuke
complexity from the scripter.&nbsp;&nbsp; We don’t need to worry about what
namespace(s) to include in our script and we don’t care that GetRoleNames needs
a PortalId as the helper method takes care of it.</span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">There is one final step that we need to
do to get this to work.&nbsp; We need to add a reference to the Helpers
namespace in the web.config file that lives in the RazorModules folder.</span></p>

<table class="MsoNormalTable" style="width: 562.5pt;" width="750" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 553.5pt; padding: 3.75pt;" valign="top" width="738">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 6 – Updating web.config</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 554.25pt; padding: 3.75pt;" valign="top" width="739">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 1:&nbsp; &lt;system.web.webPages.razor&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;
  &lt;pages pageBaseType="DotNetNuke.Web.Razor.DotNetNukeWebPage"&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;namespaces&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 4:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;add namespace="Microsoft.Web.Helpers" /&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 5:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;add namespace="WebMatrix.Data" /&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 6:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;add namespace="DotNetNuke.Web.Razor.Helpers" /&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 7:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &lt;/namespaces&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 8:&nbsp;&nbsp;&nbsp;
  &lt;/pages&gt;</span></p>
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp; 9:&nbsp;
  &lt;/system.web.webPages.razor&gt;</span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">In the final release of the Razor Host
Module, we will add the DotNetNuke.Web.Razor.Helpers namespace to the
web.config included, and we will start to flesh out the DnnHelper class with
some more intuitive methods.&nbsp; </span></p>

<p class="MsoNormal" style="line-height:normal"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">However, if you ever feel that something
is missing you can create your own.&nbsp; Just make sure that all your helper
Extension Methods are in the same namespace and all you will need to do is add
the assembly to the bin folder, and they will just work.</span></p>

<table class="MsoNormalTable" style="width: 450pt;" width="600" border="0" cellpadding="0" cellspacing="5">
 <tbody><tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="line-height:normal"><b><i><span style="font-size:
  13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;">Figure 7 – The Resulting Razor
  Script in Action.</span></i></b></p>
  </td>
 </tr>
 <tr>
  <td style="width: 450pt; padding: 3.75pt;" valign="top" width="600">
  <p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"><img id="Picture 71" src="DNNandRazor_files/image033.jpg" alt="RazorTips_03" width="195" border="0" height="113"></span></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal">[end]</p>

</div>




</body></html>